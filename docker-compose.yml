version: '3.2'
services:
    web:
        build:
            context: .
        restart: unless-stopped
        links:
            - postgres
        ports:
            - "8000:8000"
        command: "python ./manage.py runserver 0.0.0.0:8000"
        volumes:
            - .:/home/docker/code
            - type: bind
              source: ${IMAGE_DIR}
              target: /home/docker/code/media/uploads
        env_file:
            - .env
        # environment:
        #     - DJANGO_SETTINGS_MODULE=local_settings
        container_name: teachbeach_web

    postgres:
        image: kartoza/postgis:9.6-2.4
        restart: unless-stopped
        volumes:
            - ./postgres-data:/var/lib/postgresql/data
        ports:
            - "5432:5432"
        environment:
            - POSTGRES_USER=teachbeach
            - POSTGRES_PASS=dTHkivbzLLmqjvqin7A
            - POSTGRES_DB=teachbeach
        container_name: teachbeach_postgres
